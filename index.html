<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYC Training Pro - Evaluaci√≥n de Riesgo AML</title>
    <script src="scorm_api.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --secondary: #7c3aed;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --dark: #1f2937;
            --light: #f3f4f6;
            --white: #ffffff;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: var(--white);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header h1 {
            color: var(--dark);
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stats-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transform: translateY(0);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .stat-card h3 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 30px;
            animation: fadeIn 0.8s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .client-selector {
            background: var(--white);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-height: 80vh;
            overflow-y: auto;
        }

        .client-card {
            background: var(--light);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .client-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            transition: width 0.5s ease;
        }

        .client-card:hover::before {
            width: 100%;
        }

        .client-card:hover {
            transform: translateX(10px);
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(37, 99, 235, 0.2);
        }

        .client-card:hover .client-avatar {
            transform: scale(1.05);
            transition: transform 0.3s ease;
        }

        .client-card.active {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: var(--white);
            border-color: var(--secondary);
        }

        .client-card.completed {
            border-color: var(--success);
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
        }

        .client-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .client-avatar {
            width: 80px;
            height: 80px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--white);
            font-weight: bold;
            overflow: hidden;
            border: 3px solid var(--white);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .client-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .evaluation-panel {
            background: var(--white);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .client-detail {
            background: linear-gradient(135deg, #f3f4f6, #e5e7eb);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .client-detail::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(102, 126, 234, 0.1), transparent);
            border-radius: 50%;
        }

        .client-detail h2 {
            color: var(--dark);
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .detail-item {
            background: var(--white);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid var(--primary);
        }

        .detail-item strong {
            color: var(--dark);
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .risk-evaluation {
            margin-top: 30px;
        }

        .risk-section {
            background: var(--light);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .risk-section h3 {
            color: var(--dark);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .risk-indicator {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--white);
        }

        .risk-low { background: var(--success); }
        .risk-medium { background: var(--warning); }
        .risk-high { background: var(--danger); }

        .risk-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 15px;
        }

        .risk-option {
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: var(--white);
        }

        .risk-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .risk-option.selected {
            border-color: var(--primary);
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
        }

        .justification-area {
            margin-top: 15px;
        }

        .justification-area textarea {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-family: inherit;
            font-size: 1rem;
            resize: vertical;
            transition: border-color 0.3s ease;
        }

        .justification-area textarea:focus {
            outline: none;
            border-color: var(--primary);
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
        }

        .btn-secondary {
            background: var(--light);
            color: var(--dark);
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--white);
            padding: 40px;
            border-radius: 20px;
            max-width: 600px;
            width: 90%;
            animation: scaleIn 0.3s ease;
        }

        @keyframes scaleIn {
            from {
                transform: scale(0.8);
                opacity: 0;
            }
            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .score-display {
            font-size: 4rem;
            font-weight: bold;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 20px 0;
        }

        .feedback-section {
            background: var(--light);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .achievement {
            display: inline-block;
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            color: var(--white);
            padding: 10px 20px;
            border-radius: 50px;
            margin: 5px;
            font-weight: 600;
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .progress-bar {
            background: #e5e7eb;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), #34d399);
            border-radius: 15px;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: 600;
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: var(--dark);
            color: var(--white);
            text-align: center;
            border-radius: 10px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -125px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.9rem;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .photo-loading {
            animation: spin 1s linear infinite;
            opacity: 0.5;
        }

        .client-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--success);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .stats-bar {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è KYC Training Pro - Evaluaci√≥n de Riesgo AML</h1>
            <p style="color: #6b7280; font-size: 1.1rem;">Sistema Interactivo de Capacitaci√≥n en Conocimiento del Cliente</p>
            
            <div class="stats-bar">
                <div class="stat-card">
                    <h3 id="score">0</h3>
                    <p>Puntuaci√≥n Total</p>
                </div>
                <div class="stat-card">
                    <h3 id="completed">0/12</h3>
                    <p>Casos Completados</p>
                </div>
                <div class="stat-card">
                    <h3 id="accuracy">0%</h3>
                    <p>Precisi√≥n</p>
                </div>
                <div class="stat-card">
                    <h3 id="level">Novato</h3>
                    <p>Nivel Actual</p>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="client-selector">
                <h2>üìã Selecciona un Cliente</h2>
                <div id="clientList"></div>
            </div>

            <div class="evaluation-panel">
                <div id="evaluationContent">
                    <div style="text-align: center; padding: 100px 20px; color: #6b7280;">
                        <h2>üëà Selecciona un cliente para comenzar la evaluaci√≥n</h2>
                        <p style="margin-top: 20px;">Analiza cada perfil cuidadosamente y determina el nivel de riesgo AML/CFT</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="resultModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">¬°Evaluaci√≥n Completada!</h2>
            </div>
            <div class="score-display" id="modalScore">85</div>
            <div class="feedback-section" id="feedback"></div>
            <div id="achievements"></div>
            <button class="btn btn-primary" onclick="closeModal()" style="width: 100%; margin-top: 20px;">
                Continuar
            </button>
        </div>
    </div>

    <script>
        // Base de datos de clientes
        const clients = [
            {
                id: 1,
                name: "Hans M√ºller",
                photo: "https://i.pravatar.cc/300?img=33",
                address: "Av. Reforma 123, CDMX",
                nationality: "Alemana",
                occupation: "Importador de maquinaria",
                transactionality: "Transferencia internacional de $500,000 USD desde Suiza, operaciones comerciales regulares",
                volume: { amount: 500000, frequency: "mensual", cashHandling: "bajo" },
                cashManagement: "Transferencias desde cuentas en Suiza",
                fundsOrigin: "Pariente en Alemania, Exministro de Finanzas, listado como PEP",
                pepRelatives: "Perfil complejo por conexiones pol√≠ticas internacionales",
                correctRisk: "high",
                riskFactors: {
                    transactional: "high",
                    geographic: "high",
                    profile: "high",
                    pep: "high"
                }
            },
            {
                id: 2,
                name: "Juana P√©rez Luna",
                photo: "https://i.pravatar.cc/300?img=49",
                address: "Calle Tulipanes 45, Toluca",
                nationality: "Mexicana",
                occupation: "Ama de casa",
                transactionality: "Sin actividad econ√≥mica registrada, operaciones menores por transferencias familiares",
                volume: { amount: 10000, frequency: "mensual", cashHandling: "alto" },
                cashManagement: "Transferencias familiares desde Estados Unidos",
                fundsOrigin: "Esposa de un empresario que estuvo involucrado en un esc√°ndalo de corrupci√≥n",
                pepRelatives: "Posible intento de ocultar origen de fondos",
                correctRisk: "high",
                riskFactors: {
                    transactional: "medium",
                    geographic: "medium",
                    profile: "high",
                    pep: "high"
                }
            },
            {
                id: 3,
                name: "Emilio Torres Hern√°ndez",
                photo: "https://i.pravatar.cc/300?img=11",
                address: "Paseo del Sol 98, Guadalajara",
                nationality: "Mexicana",
                occupation: "Influencer digital",
                transactionality: "Recibe dep√≥sitos en efectivo por $50,000 mensuales, ingresos de plataformas digitales",
                volume: { amount: 50000, frequency: "semanal", cashHandling: "alto" },
                cashManagement: "Dep√≥sitos de seguidores, sin justificaci√≥n clara de origen",
                fundsOrigin: "Actividad de alto riesgo por no justificar origen de ingresos",
                pepRelatives: "Sin parientes PEPs",
                correctRisk: "high",
                riskFactors: {
                    transactional: "high",
                    geographic: "low",
                    profile: "high",
                    pep: "low"
                }
            },
            {
                id: 4,
                name: "Pedro Hern√°ndez Ju√°rez",
                photo: "https://i.pravatar.cc/300?img=52",
                address: "Camino Ejidal s/n, Oaxaca",
                nationality: "Mexicana",
                occupation: "Agricultor",
                transactionality: "Solicita microcr√©dito para insumos, operaciones en efectivo debido a falta de acceso bancario",
                volume: { amount: 5000, frequency: "mensual", cashHandling: "alto" },
                cashManagement: "No posee RFC ni CURP, las transacciones se realizan en efectivo",
                fundsOrigin: "Ingresos no son f√°cilmente verificables",
                pepRelatives: "Sin parientes PEPs",
                correctRisk: "medium",
                riskFactors: {
                    transactional: "medium",
                    geographic: "low",
                    profile: "medium",
                    pep: "low"
                }
            },
            {
                id: 5,
                name: "M√≥nica G√≥mez Garc√≠a",
                photo: "https://i.pravatar.cc/300?img=32",
                address: "Av. Patriotismo 750, CDMX",
                nationality: "Mexicana",
                occupation: "Abogada corporativa",
                transactionality: "Solicita servicio bancario de alto nivel para gestionar su patrimonio",
                volume: { amount: 120000, frequency: "mensual", cashHandling: "bajo" },
                cashManagement: "Dep√≥sitos provenientes de clientes corporativos",
                fundsOrigin: "Familiares involucrados en procesos legales, ninguno con perfil PEP",
                pepRelatives: "No hay familiares PEPs",
                correctRisk: "low",
                riskFactors: {
                    transactional: "low",
                    geographic: "low",
                    profile: "low",
                    pep: "low"
                }
            },
            {
                id: 6,
                name: "Luis Ramos Corona",
                photo: "https://i.pravatar.cc/300?img=60",
                address: "Calle Comercio 12, Iztapalapa",
                nationality: "Mexicana",
                occupation: "Comerciante informal",
                transactionality: "Ventas en tianguis, manejo de efectivo, dep√≥sitos menores en cuenta bancaria",
                volume: { amount: 5000, frequency: "diaria", cashHandling: "alto" },
                cashManagement: "Dep√≥sitos en efectivo de $5,000 diarios",
                fundsOrigin: "Transacciones diarias en efectivo con origen incierto",
                pepRelatives: "Sin parientes PEPs",
                correctRisk: "medium",
                riskFactors: {
                    transactional: "medium",
                    geographic: "low",
                    profile: "medium",
                    pep: "low"
                }
            },
            {
                id: 7,
                name: "Jos√© R√≠os D√≠az",
                photo: "https://i.pravatar.cc/300?img=13",
                address: "Priv. Reforma 21, Morelia",
                nationality: "Mexicana",
                occupation: "Exfuncionario p√∫blico",
                transactionality: "Movimientos internacionales recientes, inversi√≥n en fondos privados",
                volume: { amount: 250000, frequency: "mensual", cashHandling: "bajo" },
                cashManagement: "Transferencias de fondos desde cuentas en para√≠sos fiscales",
                fundsOrigin: "Exfuncionario de alto rango, parientes relacionados con contratos p√∫blicos",
                pepRelatives: "Posible lavado de activos debido a conexiones con recursos p√∫blicos",
                correctRisk: "high",
                riskFactors: {
                    transactional: "high",
                    geographic: "high",
                    profile: "high",
                    pep: "high"
                }
            },
            {
                id: 8,
                name: "Ana Robles Moreno",
                photo: "https://i.pravatar.cc/300?img=44",
                address: "Av. Salud 321, Monterrey",
                nationality: "Mexicana",
                occupation: "M√©dico especialista",
                transactionality: "Solicita cr√©dito automotriz, ingresos por honorarios y n√≥mina",
                volume: { amount: 100000, frequency: "mensual", cashHandling: "bajo" },
                cashManagement: "Ingresos provenientes de su consultorio y hospitales privados",
                fundsOrigin: "Posible irregularidad en los pagos en efectivo que no concuerdan con su perfil",
                pepRelatives: "Sin parientes PEPs",
                correctRisk: "medium",
                riskFactors: {
                    transactional: "low",
                    geographic: "low",
                    profile: "medium",
                    pep: "low"
                }
            },
            {
                id: 9,
                name: "Yu Chen",
                photo: "https://i.pravatar.cc/300?img=5",
                address: "Residencial UNAM, CDMX",
                nationality: "China",
                occupation: "Estudiante",
                transactionality: "Recibe beca del gobierno chino, mantiene una cuenta para transferencias",
                volume: { amount: 10000, frequency: "mensual", cashHandling: "bajo" },
                cashManagement: "Transferencias mensuales del gobierno de China",
                fundsOrigin: "Situaci√≥n financiera muy dependiente de una beca gubernamental",
                pepRelatives: "Sin parientes PEPs",
                correctRisk: "low",
                riskFactors: {
                    transactional: "low",
                    geographic: "medium",
                    profile: "low",
                    pep: "low"
                }
            },
            {
                id: 10,
                name: "Daniel Cruz Gonz√°lez",
                photo: "https://i.pravatar.cc/300?img=7",
                address: "Calle Startups 404, Quer√©taro",
                nationality: "Mexicana",
                occupation: "Desarrollador Fintech",
                transactionality: "Solicita cuenta bancaria para aplicaci√≥n financiera, sin RFC",
                volume: { amount: 20000, frequency: "mensual", cashHandling: "bajo" },
                cashManagement: "Inversiones en criptomonedas y tecnolog√≠a emergente",
                fundsOrigin: "La empresa a√∫n no est√° registrada ante el SAT",
                pepRelatives: "Sin parientes PEPs",
                correctRisk: "medium",
                riskFactors: {
                    transactional: "medium",
                    geographic: "low",
                    profile: "medium",
                    pep: "low"
                }
            },
            {
                id: 11,
                name: "Antonio Rivera Mar√≠n",
                photo: "https://i.pravatar.cc/300?img=70",
                address: "Madero 200, Mexicali",
                nationality: "Mexicana",
                occupation: "Pensionado",
                transactionality: "Recibe pensi√≥n mensual, operaciones recurrentes en su cuenta por $10,000",
                volume: { amount: 10000, frequency: "mensual", cashHandling: "bajo" },
                cashManagement: "Pensi√≥n por parte del gobierno",
                fundsOrigin: "Caso de bajo riesgo debido a ingresos estables y verificables",
                pepRelatives: "Sin parientes PEPs",
                correctRisk: "low",
                riskFactors: {
                    transactional: "low",
                    geographic: "low",
                    profile: "low",
                    pep: "low"
                }
            },
            {
                id: 12,
                name: "Laura M√©ndez",
                photo: "https://i.pravatar.cc/300?img=45",
                address: "Guerrero 900, Monterrey",
                nationality: "Mexicana",
                occupation: "Modelo de TV",
                transactionality: "Recibe pagos mensuales por contrato de exclusividad, operaciones por $50,000 mensuales",
                volume: { amount: 50000, frequency: "mensual", cashHandling: "bajo" },
                cashManagement: "Bajo, alta visibilidad en medios",
                fundsOrigin: "Pagos por contrato y eventos",
                pepRelatives: "Sin parientes PEPs",
                correctRisk: "low",
                riskFactors: {
                    transactional: "low",
                    geographic: "low",
                    profile: "low",
                    pep: "low"
                }
            }
        ];

        // Estado de la aplicaci√≥n
        let gameState = {
            currentClient: null,
            completedClients: [],
            totalScore: 0,
            evaluations: {},
            achievements: []
        };

        // Inicializar la aplicaci√≥n
        function init() {
            // Inicializar SCORM si est√° disponible
            if (typeof SCORM_API !== 'undefined') {
                SCORM_API.init();
            }
            
            loadGameState();
            renderClientList();
            updateStats();
        }

        // Cargar estado del juego
        function loadGameState() {
            const saved = localStorage.getItem('kycGameState');
            if (saved) {
                gameState = JSON.parse(saved);
            }
        }

        // Guardar estado del juego
        function saveGameState() {
            localStorage.setItem('kycGameState', JSON.stringify(gameState));
        }

        // Renderizar lista de clientes
        function renderClientList() {
            const listContainer = document.getElementById('clientList');
            listContainer.innerHTML = '';

            clients.forEach(client => {
                const isCompleted = gameState.completedClients.includes(client.id);
                const card = document.createElement('div');
                card.className = `client-card ${isCompleted ? 'completed' : ''}`;
                card.onclick = () => selectClient(client.id);

                card.innerHTML = `
                    <div class="client-info">
                        <div class="client-avatar">
                            <img src="${client.photo}" alt="${client.name}" onerror="this.style.display='none'; this.parentElement.innerHTML='${client.name.split(' ').map(n => n[0]).join('')}'">
                        </div>
                        <div>
                            <h3>${client.name}</h3>
                            <p style="color: #6b7280; font-size: 0.9rem;">${client.occupation}</p>
                            ${isCompleted ? '<span style="color: #10b981;">‚úì Completado</span>' : '<span style="color: #9ca3af;">Pendiente</span>'}
                        </div>
                    </div>
                `;

                listContainer.appendChild(card);
            });
        }

        // Seleccionar cliente
        function selectClient(clientId) {
            const client = clients.find(c => c.id === clientId);
            gameState.currentClient = client;

            // Actualizar UI
            document.querySelectorAll('.client-card').forEach(card => {
                card.classList.remove('active');
            });
            event.currentTarget.classList.add('active');

            renderEvaluation(client);
        }

        // Renderizar evaluaci√≥n
        function renderEvaluation(client) {
            const container = document.getElementById('evaluationContent');
            
            container.innerHTML = `
                <div class="client-detail">
                    <h2>üìä Evaluaci√≥n de Riesgo: ${client.name}</h2>
                    
                    <div class="detail-grid">
                        <div class="detail-item">
                            <strong>Nacionalidad</strong>
                            <span>${client.nationality}</span>
                        </div>
                        <div class="detail-item">
                            <strong>Ocupaci√≥n</strong>
                            <span>${client.occupation}</span>
                        </div>
                        <div class="detail-item">
                            <strong>Direcci√≥n</strong>
                            <span>${client.address}</span>
                        </div>
                        <div class="detail-item">
                            <strong>Volumen de Operaciones</strong>
                            <span>${client.volume.amount.toLocaleString()} ${client.volume.frequency}</span>
                        </div>
                    </div>

                    <div class="detail-grid" style="margin-top: 15px;">
                        <div class="detail-item" style="grid-column: span 2;">
                            <strong>Transaccionalidad</strong>
                            <span>${client.transactionality}</span>
                        </div>
                        <div class="detail-item" style="grid-column: span 2;">
                            <strong>Manejo de Efectivo</strong>
                            <span>${client.cashManagement}</span>
                        </div>
                        <div class="detail-item" style="grid-column: span 2;">
                            <strong>Origen de Fondos</strong>
                            <span>${client.fundsOrigin}</span>
                        </div>
                        <div class="detail-item" style="grid-column: span 2;">
                            <strong>Parientes PEPs</strong>
                            <span>${client.pepRelatives}</span>
                        </div>
                    </div>
                </div>

                <div class="risk-evaluation">
                    <h3 style="color: #1f2937; margin-bottom: 20px;">
                        üéØ Evaluaci√≥n de Factores de Riesgo
                    </h3>

                    <!-- Factor 1: Riesgo Transaccional -->
                    <div class="risk-section">
                        <h3>
                            <span class="risk-indicator risk-medium">1</span>
                            Riesgo Transaccional
                            <span class="tooltip">‚ùì
                                <span class="tooltiptext">Eval√∫a el volumen, frecuencia y naturaleza de las transacciones del cliente</span>
                            </span>
                        </h3>
                        <div class="risk-options">
                            <div class="risk-option" onclick="selectRisk('transactional', 'low', this)">
                                <div style="font-size: 2rem;">üü¢</div>
                                <strong>Bajo</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Transacciones regulares y justificadas</p>
                            </div>
                            <div class="risk-option" onclick="selectRisk('transactional', 'medium', this)">
                                <div style="font-size: 2rem;">üü°</div>
                                <strong>Medio</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Algunas irregularidades menores</p>
                            </div>
                            <div class="risk-option" onclick="selectRisk('transactional', 'high', this)">
                                <div style="font-size: 2rem;">üî¥</div>
                                <strong>Alto</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Transacciones inusuales o sin justificar</p>
                            </div>
                        </div>
                        <div class="justification-area">
                            <textarea id="transactional-justification" placeholder="Justifica tu evaluaci√≥n del riesgo transaccional..."></textarea>
                        </div>
                    </div>

                    <!-- Factor 2: Riesgo Geogr√°fico -->
                    <div class="risk-section">
                        <h3>
                            <span class="risk-indicator risk-medium">2</span>
                            Riesgo Geogr√°fico
                            <span class="tooltip">‚ùì
                                <span class="tooltiptext">Considera el riesgo asociado con el pa√≠s de origen, residencia y operaciones</span>
                            </span>
                        </h3>
                        <div class="risk-options">
                            <div class="risk-option" onclick="selectRisk('geographic', 'low', this)">
                                <div style="font-size: 2rem;">üü¢</div>
                                <strong>Bajo</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Pa√≠ses de bajo riesgo</p>
                            </div>
                            <div class="risk-option" onclick="selectRisk('geographic', 'medium', this)">
                                <div style="font-size: 2rem;">üü°</div>
                                <strong>Medio</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Pa√≠ses con riesgo moderado</p>
                            </div>
                            <div class="risk-option" onclick="selectRisk('geographic', 'high', this)">
                                <div style="font-size: 2rem;">üî¥</div>
                                <strong>Alto</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Para√≠sos fiscales o pa√≠ses sancionados</p>
                            </div>
                        </div>
                        <div class="justification-area">
                            <textarea id="geographic-justification" placeholder="Justifica tu evaluaci√≥n del riesgo geogr√°fico..."></textarea>
                        </div>
                    </div>

                    <!-- Factor 3: Riesgo del Perfil -->
                    <div class="risk-section">
                        <h3>
                            <span class="risk-indicator risk-medium">3</span>
                            Riesgo del Perfil del Cliente
                            <span class="tooltip">‚ùì
                                <span class="tooltiptext">Eval√∫a la coherencia entre la actividad econ√≥mica y el perfil del cliente</span>
                            </span>
                        </h3>
                        <div class="risk-options">
                            <div class="risk-option" onclick="selectRisk('profile', 'low', this)">
                                <div style="font-size: 2rem;">üü¢</div>
                                <strong>Bajo</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Perfil coherente y verificable</p>
                            </div>
                            <div class="risk-option" onclick="selectRisk('profile', 'medium', this)">
                                <div style="font-size: 2rem;">üü°</div>
                                <strong>Medio</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Algunas inconsistencias</p>
                            </div>
                            <div class="risk-option" onclick="selectRisk('profile', 'high', this)">
                                <div style="font-size: 2rem;">üî¥</div>
                                <strong>Alto</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Perfil inconsistente o no verificable</p>
                            </div>
                        </div>
                        <div class="justification-area">
                            <textarea id="profile-justification" placeholder="Justifica tu evaluaci√≥n del riesgo del perfil..."></textarea>
                        </div>
                    </div>

                    <!-- Factor 4: Riesgo PEP -->
                    <div class="risk-section">
                        <h3>
                            <span class="risk-indicator risk-medium">4</span>
                            Riesgo PEP (Persona Expuesta Pol√≠ticamente)
                            <span class="tooltip">‚ùì
                                <span class="tooltiptext">Eval√∫a si el cliente o sus familiares son PEPs</span>
                            </span>
                        </h3>
                        <div class="risk-options">
                            <div class="risk-option" onclick="selectRisk('pep', 'low', this)">
                                <div style="font-size: 2rem;">üü¢</div>
                                <strong>Bajo</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Sin conexiones PEP</p>
                            </div>
                            <div class="risk-option" onclick="selectRisk('pep', 'medium', this)">
                                <div style="font-size: 2rem;">üü°</div>
                                <strong>Medio</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Conexiones PEP indirectas</p>
                            </div>
                            <div class="risk-option" onclick="selectRisk('pep', 'high', this)">
                                <div style="font-size: 2rem;">üî¥</div>
                                <strong>Alto</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Cliente o familiares directos PEP</p>
                            </div>
                        </div>
                        <div class="justification-area">
                            <textarea id="pep-justification" placeholder="Justifica tu evaluaci√≥n del riesgo PEP..."></textarea>
                        </div>
                    </div>

                    <!-- Evaluaci√≥n Final -->
                    <div class="risk-section" style="background: linear-gradient(135deg, #dbeafe, #bfdbfe);">
                        <h3>
                            <span class="risk-indicator risk-high">‚òÖ</span>
                            Evaluaci√≥n Final del Riesgo
                        </h3>
                        <div class="risk-options">
                            <div class="risk-option" onclick="selectFinalRisk('low', this)">
                                <div style="font-size: 3rem;">üü¢</div>
                                <strong>RIESGO BAJO</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Cliente de bajo riesgo</p>
                            </div>
                            <div class="risk-option" onclick="selectFinalRisk('medium', this)">
                                <div style="font-size: 3rem;">üü°</div>
                                <strong>RIESGO MEDIO</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Requiere monitoreo regular</p>
                            </div>
                            <div class="risk-option" onclick="selectFinalRisk('high', this)">
                                <div style="font-size: 3rem;">üî¥</div>
                                <strong>RIESGO ALTO</strong>
                                <p style="font-size: 0.85rem; margin-top: 5px;">Requiere debida diligencia reforzada</p>
                            </div>
                        </div>
                        <div class="justification-area">
                            <textarea id="final-justification" placeholder="Proporciona una conclusi√≥n general sobre el nivel de riesgo del cliente y las medidas recomendadas..." style="min-height: 120px;"></textarea>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn btn-secondary" onclick="resetEvaluation()">
                            üîÑ Reiniciar Evaluaci√≥n
                        </button>
                        <button class="btn btn-primary" onclick="submitEvaluation()">
                            ‚úÖ Enviar Evaluaci√≥n
                        </button>
                    </div>
                </div>
            `;

            // Restaurar evaluaci√≥n previa si existe
            if (gameState.evaluations[client.id]) {
                restoreEvaluation(client.id);
            }
        }

        // Variables para almacenar las selecciones
        let currentEvaluation = {
            transactional: null,
            geographic: null,
            profile: null,
            pep: null,
            finalRisk: null,
            justifications: {}
        };

        // Seleccionar riesgo
        function selectRisk(category, level, element) {
            // Limpiar selecci√≥n previa
            const parent = element.parentElement;
            parent.querySelectorAll('.risk-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Marcar como seleccionado
            element.classList.add('selected');
            
            // Guardar selecci√≥n
            currentEvaluation[category] = level;
        }

        // Seleccionar riesgo final
        function selectFinalRisk(level, element) {
            // Limpiar selecci√≥n previa
            const parent = element.parentElement;
            parent.querySelectorAll('.risk-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            // Marcar como seleccionado
            element.classList.add('selected');
            
            // Guardar selecci√≥n
            currentEvaluation.finalRisk = level;
        }

        // Reiniciar evaluaci√≥n
        function resetEvaluation() {
            currentEvaluation = {
                transactional: null,
                geographic: null,
                profile: null,
                pep: null,
                finalRisk: null,
                justifications: {}
            };
            
            // Limpiar UI
            document.querySelectorAll('.risk-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            
            document.querySelectorAll('textarea').forEach(textarea => {
                textarea.value = '';
            });
        }

        // Enviar evaluaci√≥n
        function submitEvaluation() {
            // Validar que todos los campos est√©n completos
            if (!currentEvaluation.transactional || !currentEvaluation.geographic || 
                !currentEvaluation.profile || !currentEvaluation.pep || !currentEvaluation.finalRisk) {
                alert('Por favor completa todas las evaluaciones de riesgo');
                return;
            }

            // Obtener justificaciones
            currentEvaluation.justifications = {
                transactional: document.getElementById('transactional-justification').value,
                geographic: document.getElementById('geographic-justification').value,
                profile: document.getElementById('profile-justification').value,
                pep: document.getElementById('pep-justification').value,
                final: document.getElementById('final-justification').value
            };

            // Validar justificaciones
            const hasJustifications = Object.values(currentEvaluation.justifications).every(j => j && j.length > 10);
            if (!hasJustifications) {
                alert('Por favor proporciona justificaciones detalladas para cada evaluaci√≥n (m√≠nimo 10 caracteres)');
                return;
            }

            // Calcular puntuaci√≥n
            const score = calculateScore();
            
            // Guardar evaluaci√≥n
            gameState.evaluations[gameState.currentClient.id] = {
                ...currentEvaluation,
                score: score,
                timestamp: new Date().toISOString()
            };

            // Marcar como completado
            if (!gameState.completedClients.includes(gameState.currentClient.id)) {
                gameState.completedClients.push(gameState.currentClient.id);
                gameState.totalScore += score;
            }

            // Verificar logros
            checkAchievements();

            // Guardar estado
            saveGameState();
            
            // Integraci√≥n con SCORM si est√° disponible
            if (typeof SCORM_API !== 'undefined') {
                SCORM_API.setScore(score);
                SCORM_API.saveInteraction(
                    gameState.currentClient.name,
                    currentEvaluation.finalRisk,
                    gameState.currentClient.correctRisk,
                    score
                );
                SCORM_API.setProgress(gameState.completedClients.length, 12);
            }

            // Mostrar resultados
            showResults(score);

            // Actualizar estad√≠sticas
            updateStats();
        }

        // Calcular puntuaci√≥n
        function calculateScore() {
            const client = gameState.currentClient;
            let score = 0;
            let maxScore = 100;

            // Puntos por cada factor correcto (15 puntos cada uno)
            const factors = ['transactional', 'geographic', 'profile', 'pep'];
            factors.forEach(factor => {
                if (currentEvaluation[factor] === client.riskFactors[factor]) {
                    score += 15;
                }
            });

            // Puntos por evaluaci√≥n final correcta (30 puntos)
            if (currentEvaluation.finalRisk === client.correctRisk) {
                score += 30;
            }

            // Puntos por justificaciones (10 puntos)
            const justificationQuality = evaluateJustifications();
            score += justificationQuality;

            return Math.min(score, maxScore);
        }

        // Evaluar calidad de justificaciones
        function evaluateJustifications() {
            let points = 0;
            const justifications = currentEvaluation.justifications;

            // Evaluar longitud y palabras clave
            Object.values(justifications).forEach(just => {
                if (just.length > 50) points += 1;
                if (just.length > 100) points += 1;
                
                // Palabras clave relevantes
                const keywords = ['riesgo', 'transacci√≥n', 'origen', 'fondos', 'pep', 'verificar', 
                                'monitoreo', 'debida diligencia', 'sospechoso', 'irregular'];
                const hasKeywords = keywords.some(keyword => just.toLowerCase().includes(keyword));
                if (hasKeywords) points += 0.5;
            });

            return Math.min(points, 10);
        }

        // Mostrar resultados
        function showResults(score) {
            const modal = document.getElementById('resultModal');
            const client = gameState.currentClient;
            
            // T√≠tulo seg√∫n el resultado
            let title = '¬°Evaluaci√≥n Completada!';
            let feedbackClass = '';
            
            if (score >= 90) {
                title = '¬°Excelente Trabajo! üèÜ';
                feedbackClass = 'excellent';
            } else if (score >= 70) {
                title = '¬°Buen Trabajo! üëç';
                feedbackClass = 'good';
            } else if (score >= 50) {
                title = 'Resultado Regular üìä';
                feedbackClass = 'regular';
            } else {
                title = 'Necesitas Mejorar üìö';
                feedbackClass = 'poor';
            }

            document.getElementById('modalTitle').innerHTML = title;
            document.getElementById('modalScore').innerHTML = score + '/100';

            // Generar feedback detallado
            let feedback = '<h3>üìã Retroalimentaci√≥n Detallada</h3>';
            
            // Comparar cada factor
            const factors = [
                { key: 'transactional', label: 'Riesgo Transaccional' },
                { key: 'geographic', label: 'Riesgo Geogr√°fico' },
                { key: 'profile', label: 'Riesgo del Perfil' },
                { key: 'pep', label: 'Riesgo PEP' }
            ];

            feedback += '<div style="margin-top: 15px;">';
            factors.forEach(factor => {
                const isCorrect = currentEvaluation[factor.key] === client.riskFactors[factor.key];
                const icon = isCorrect ? '‚úÖ' : '‚ùå';
                const yourAnswer = currentEvaluation[factor.key];
                const correctAnswer = client.riskFactors[factor.key];
                
                feedback += `
                    <div style="margin-bottom: 10px; padding: 10px; background: ${isCorrect ? '#d1fae5' : '#fee2e2'}; border-radius: 8px;">
                        <strong>${icon} ${factor.label}</strong><br>
                        Tu respuesta: <span style="text-transform: uppercase;">${yourAnswer}</span><br>
                        ${!isCorrect ? `Respuesta correcta: <span style="text-transform: uppercase; color: #ef4444;">${correctAnswer}</span>` : ''}
                    </div>
                `;
            });

            // Evaluaci√≥n final
            const finalCorrect = currentEvaluation.finalRisk === client.correctRisk;
            feedback += `
                <div style="margin-bottom: 10px; padding: 10px; background: ${finalCorrect ? '#d1fae5' : '#fee2e2'}; border-radius: 8px;">
                    <strong>${finalCorrect ? '‚úÖ' : '‚ùå'} Evaluaci√≥n Final</strong><br>
                    Tu respuesta: <span style="text-transform: uppercase;">${currentEvaluation.finalRisk}</span><br>
                    ${!finalCorrect ? `Respuesta correcta: <span style="text-transform: uppercase; color: #ef4444;">${client.correctRisk}</span>` : ''}
                </div>
            `;
            feedback += '</div>';

            // Explicaci√≥n del caso
            feedback += `
                <div style="margin-top: 20px; padding: 15px; background: #f3f4f6; border-radius: 10px;">
                    <h4 style="color: #1f2937; margin-bottom: 10px;">üí° Explicaci√≥n del Caso</h4>
                    <p style="color: #4b5563; line-height: 1.6;">
                        ${getClientExplanation(client)}
                    </p>
                </div>
            `;

            document.getElementById('feedback').innerHTML = feedback;

            // Mostrar logros si hay nuevos
            const achievementsDiv = document.getElementById('achievements');
            if (gameState.achievements.length > 0) {
                achievementsDiv.innerHTML = '<h3 style="margin-top: 20px;">üèÖ Logros Desbloqueados</h3>';
                gameState.achievements.forEach(achievement => {
                    achievementsDiv.innerHTML += `<span class="achievement">${achievement}</span>`;
                });
            }

            modal.classList.add('active');
        }

        // Obtener explicaci√≥n del cliente
        function getClientExplanation(client) {
            const explanations = {
                1: "Hans M√ºller presenta un riesgo ALTO debido a m√∫ltiples factores: transferencias internacionales de gran volumen desde Suiza (para√≠so fiscal), conexiones familiares con PEPs (Exministro de Finanzas), y la naturaleza de sus operaciones comerciales internacionales. Requiere debida diligencia reforzada y monitoreo continuo.",
                2: "Juana P√©rez Luna es de riesgo ALTO. Aunque declara ser ama de casa sin actividad econ√≥mica, recibe transferencias significativas y su esposo estuvo involucrado en esc√°ndalos de corrupci√≥n. Existe un posible intento de ocultar el origen de los fondos.",
                3: "Emilio Torres es de riesgo ALTO. Como influencer, recibe grandes cantidades en efectivo sin justificaci√≥n clara del origen. La naturaleza de su actividad econ√≥mica dificulta la verificaci√≥n del origen l√≠cito de los fondos.",
                4: "Pedro Hern√°ndez presenta riesgo MEDIO. Como agricultor en zona rural, el manejo de efectivo es comprensible por la falta de acceso bancario, pero la falta de documentaci√≥n formal (RFC/CURP) dificulta la verificaci√≥n.",
                5: "M√≥nica G√≥mez es de riesgo BAJO. Abogada corporativa con ingresos justificados y verificables, sin conexiones PEP y operaciones coherentes con su perfil profesional.",
                6: "Luis Ramos tiene riesgo MEDIO. Como comerciante informal, el alto manejo de efectivo es esperado, pero los dep√≥sitos diarios de $5,000 requieren monitoreo para detectar posible estructuraci√≥n.",
                7: "Jos√© R√≠os es de riesgo ALTO. Exfuncionario con movimientos desde para√≠sos fiscales y familiares relacionados con contratos p√∫blicos. Alta probabilidad de lavado de activos provenientes de corrupci√≥n.",
                8: "Ana Robles presenta riesgo MEDIO. Aunque es m√©dico especialista, hay irregularidades en los pagos en efectivo que no concuerdan completamente con su perfil profesional.",
                9: "Yu Chen es de riesgo BAJO. Estudiante con fondos verificables provenientes de beca gubernamental. El riesgo geogr√°fico es moderado pero mitigado por la naturaleza institucional de los fondos.",
                10: "Daniel Cruz tiene riesgo MEDIO. La falta de registro formal de su empresa y las inversiones en criptomonedas presentan desaf√≠os para la trazabilidad de fondos.",
                11: "Antonio Rivera es de riesgo BAJO. Pensionado con ingresos estables y verificables del gobierno, sin se√±ales de alerta.",
                12: "Laura M√©ndez es de riesgo BAJO. Modelo con alta visibilidad p√∫blica, contratos verificables y operaciones coherentes con su actividad profesional."
            };

            return explanations[client.id] || "Evaluaci√≥n basada en los factores de riesgo identificados.";
        }

        // Verificar logros
        function checkAchievements() {
            const newAchievements = [];

            // Primer caso completado
            if (gameState.completedClients.length === 1) {
                newAchievements.push('üéØ Primera Evaluaci√≥n');
            }

            // 5 casos completados
            if (gameState.completedClients.length === 5) {
                newAchievements.push('‚≠ê Analista en Progreso');
            }

            // Todos los casos completados
            if (gameState.completedClients.length === 12) {
                newAchievements.push('üèÜ Experto KYC');
            }

            // Puntuaci√≥n perfecta
            const lastEval = gameState.evaluations[gameState.currentClient.id];
            if (lastEval && lastEval.score === 100) {
                newAchievements.push('üíØ Evaluaci√≥n Perfecta');
            }

            // Racha de 3 evaluaciones correctas
            const lastThree = gameState.completedClients.slice(-3);
            if (lastThree.length === 3) {
                const allGood = lastThree.every(id => gameState.evaluations[id].score >= 80);
                if (allGood) {
                    newAchievements.push('üî• Racha de Excelencia');
                }
            }

            gameState.achievements = newAchievements;
        }

        // Actualizar estad√≠sticas
        function updateStats() {
            const completed = gameState.completedClients.length;
            const total = clients.length;
            
            document.getElementById('score').innerHTML = gameState.totalScore;
            document.getElementById('completed').innerHTML = `${completed}/${total}`;
            
            // Calcular precisi√≥n
            let accuracy = 0;
            if (completed > 0) {
                const avgScore = gameState.totalScore / completed;
                accuracy = Math.round(avgScore);
            }
            document.getElementById('accuracy').innerHTML = accuracy + '%';
            
            // Determinar nivel
            let level = 'Novato';
            if (gameState.totalScore >= 1000) {
                level = 'Experto';
            } else if (gameState.totalScore >= 700) {
                level = 'Avanzado';
            } else if (gameState.totalScore >= 400) {
                level = 'Intermedio';
            } else if (gameState.totalScore >= 100) {
                level = 'Principiante';
            }
            document.getElementById('level').innerHTML = level;
        }

        // Cerrar modal
        function closeModal() {
            document.getElementById('resultModal').classList.remove('active');
            
            // Actualizar lista de clientes
            renderClientList();
        }

        // Restaurar evaluaci√≥n previa
        function restoreEvaluation(clientId) {
            const saved = gameState.evaluations[clientId];
            if (saved) {
                currentEvaluation = {
                    transactional: saved.transactional,
                    geographic: saved.geographic,
                    profile: saved.profile,
                    pep: saved.pep,
                    finalRisk: saved.finalRisk,
                    justifications: saved.justifications
                };

                // Restaurar UI
                // TODO: Implementar restauraci√≥n visual
            }
        }

        // Inicializar al cargar la p√°gina
        window.onload = init;
        
        // Finalizar SCORM al cerrar
        window.addEventListener('beforeunload', function() {
            if (typeof SCORM_API !== 'undefined') {
                SCORM_API.finish();
            }
        });
    </script>
</body>
</html>
